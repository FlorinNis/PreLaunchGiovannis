spring.application.name=prelaunch
server.port=8085

# --- DATABASE CONFIGURATION (H2 In-Memory) ---
spring.datasource.url=jdbc:h2:mem:prelaunchdb
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=password

# --- JPA / HIBERNATE ---
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
# 'update' will create the schema based on your entities automatically
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true

# --- H2 CONSOLE (Access at /h2-console) ---
spring.h2.console.enabled=true
spring.h2.console.path=/h2-console

# --- RATE LIMITING (Bucket4j) ---
bucket4j.enabled=true
bucket4j.filters[0].cache-name=rate-limit-bucket
# Apply strict limits to critical actions
bucket4j.filters[0].url=^(/join|/checkout|/cart/add/.*)$
# Rate limit strategy: IP Address
bucket4j.filters[0].rate-limits[0].expression=getRemoteAddr()
# Allow 20 requests per minute
bucket4j.filters[0].rate-limits[0].bandwidths[0].capacity=20
bucket4j.filters[0].rate-limits[0].bandwidths[0].time=1
bucket4j.filters[0].rate-limits[0].bandwidths[0].unit=minutes
# Return 429 status code
bucket4j.filters[0].http-response-body={ "status": 429, "error": "Too Many Requests", "message": "TRAFFIC_ANOMALY_DETECTED" }